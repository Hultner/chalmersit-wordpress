/*
	Javascripts for Chalmers.it
	--------------------------------
	Files: [jquery.smoothscroll, jquery.autosize, jquery.tipsy, jquery.modal, chalmersit.courses, chalmersit]
	Build date: 2013-08-22 23:37
 */

(function(a){function h(e){return e.replace(/(:|\.)/g,"\\$1")}var c=function(e){var b=[],d=false,f=e.dir&&e.dir=="left"?"scrollLeft":"scrollTop";this.each(function(){if(!(this==document||this==window)){var g=a(this);if(g[f]()>0)b.push(this);else{g[f](1);(d=g[f]()>0)&&b.push(this);g[f](0)}}});b.length||this.each(function(){if(this.nodeName==="BODY")b=[this]});if(e.el==="first"&&b.length>1)b=[b[0]];return b};a.fn.extend({scrollable:function(e){return this.pushStack(c.call(this,{dir:e}))},firstScrollable:function(e){return this.pushStack(c.call(this,
{el:"first",dir:e}))},smoothScroll:function(e){e=e||{};var b=a.extend({},a.fn.smoothScroll.defaults,e),d=a.smoothScroll.filterPath(location.pathname);this.unbind("click.smoothscroll").bind("click.smoothscroll",function(f){var g=a(this),i=b.exclude,j=b.excludeWithin,k=0,m=0,l=true,o={},q=location.hostname===this.hostname||!this.hostname,r=b.scrollTarget||(a.smoothScroll.filterPath(this.pathname)||d)===d,s=h(this.hash);if(!b.scrollTarget&&(!q||!r||!s))l=false;else{for(;l&&k<i.length;)if(g.is(h(i[k++])))l=
false;for(;l&&m<j.length;)if(g.closest(j[m++]).length)l=false}if(l){f.preventDefault();a.extend(o,b,{scrollTarget:b.scrollTarget||s,link:this});a.smoothScroll(o)}});return this}});a.smoothScroll=function(e,b){var d,f,g,i;i=0;var j="offset",k="scrollTop",m={};g={};if(typeof e==="number"){d=a.fn.smoothScroll.defaults;g=e}else{d=a.extend({},a.fn.smoothScroll.defaults,e||{});if(d.scrollElement){j="position";d.scrollElement.css("position")=="static"&&d.scrollElement.css("position","relative")}}d=a.extend({link:null},
d);k=d.direction=="left"?"scrollLeft":k;if(d.scrollElement){f=d.scrollElement;i=f[k]()}else f=a("html, body").firstScrollable();d.beforeScroll.call(f,d);g=typeof e==="number"?e:b||a(d.scrollTarget)[j]()&&a(d.scrollTarget)[j]()[d.direction]||0;m[k]=g+i+d.offset;i=d.speed;if(i==="auto"){i=m[k]||f.scrollTop();i/=d.autoCoefficent}g={duration:i,easing:d.easing,complete:function(){d.afterScroll.call(d.link,d)}};if(d.step)g.step=d.step;f.length?f.stop().animate(m,g):d.afterScroll.call(d.link,d)};a.smoothScroll.version=
"@VERSION";a.smoothScroll.filterPath=function(e){return e.replace(/^\//,"").replace(/(index|default).[a-zA-Z]{3,4}$/,"").replace(/\/$/,"")};a.fn.smoothScroll.defaults={exclude:[],excludeWithin:[],offset:0,direction:"top",scrollElement:null,scrollTarget:null,beforeScroll:function(){},afterScroll:function(){},easing:"swing",speed:400,autoCoefficent:2}})(jQuery);
(function(a){var h={className:"autosizejs",append:"",callback:false},c="hidden",e=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],b,d=a('<textarea tabindex="-1" style="position:absolute; top:-9999px; left:-9999px; right:auto; bottom:auto; border:0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden;"/>').data("autosize",
true)[0];d.style.lineHeight="99px";a(d).css("lineHeight")==="99px"&&e.push("lineHeight");d.style.lineHeight="";a.fn.autosize=function(f){f=a.extend({},h,f||{});d.parentNode!==document.body&&a(document.body).append(d);return this.each(function(){function g(){b=j;d.className=f.className;a.each(e,function(n,p){d.style[p]=k.css(p)})}function i(){var n,p,t;b!==j&&g();if(!o){o=true;d.value=j.value+f.append;d.style.overflowY=j.style.overflowY;t=parseInt(j.style.height,10);d.style.width=k.width()+"px";d.scrollTop=
0;d.scrollTop=9E4;n=d.scrollTop;if(n>l){n=l;p="scroll"}else if(n<m)n=m;n+=r;j.style.overflowY=p||c;if(t!==n){j.style.height=n+"px";u&&f.callback.call(j)}setTimeout(function(){o=false},1)}}var j=this,k=a(j),m=k.height(),l=parseInt(k.css("maxHeight"),10),o,q,r=0,s=j.value,u=a.isFunction(f.callback);if(!k.data("autosize")){if(k.css("box-sizing")==="border-box"||k.css("-moz-box-sizing")==="border-box"||k.css("-webkit-box-sizing")==="border-box")r=k.outerHeight()-k.height();q=k.css("resize")==="none"?
"none":"horizontal";k.css({overflow:c,overflowY:c,wordWrap:"break-word",resize:q}).data("autosize",true);l=l&&l>0?l:9E4;if("onpropertychange"in j)if("oninput"in j)j.oninput=j.onkeyup=i;else j.onpropertychange=i;else{j.oninput=i;j.value="";j.value=s}a(window).resize(i);k.bind("autosize",i);k.bind("focus",i)}})}})(window.jQuery||window.Zepto);
(function(a){function h(c,e){this.$element=a(c);this.options=e;this.enabled=true;this.fixTitle()}h.prototype={show:function(){var c=this.getTitle();if(c&&this.enabled){var e=this.tip();e.find(".tipsy-inner")[this.options.html?"html":"text"](c);e[0].className="tipsy";e.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).prependTo(document.body);c=a.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight});var b=e[0].offsetWidth,d=e[0].offsetHeight,
f=typeof this.options.gravity=="function"?this.options.gravity.call(this.$element[0]):this.options.gravity,g;switch(f.charAt(0)){case "n":g={top:c.top+c.height+this.options.offset,left:c.left+c.width/2-b/2};break;case "s":g={top:c.top-d-this.options.offset,left:c.left+c.width/2-b/2};break;case "e":g={top:c.top+c.height/2-d/2,left:c.left-b-this.options.offset};break;case "w":g={top:c.top+c.height/2-d/2,left:c.left+c.width+this.options.offset}}if(f.length==2)g.left=f.charAt(1)=="w"?c.left+c.width/2-
15:c.left+c.width/2-b+15;e.css(g).addClass("tipsy-"+f);e.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+f.charAt(0);this.options.className&&e.addClass(typeof this.options.className=="function"?this.options.className.call(this.$element[0]):this.options.className);this.options.fade?e.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):e.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){a(this).remove()}):
this.tip().remove()},fixTitle:function(){var c=this.$element;if(c.attr("title")||typeof c.attr("original-title")!="string")c.attr("original-title",c.attr("title")||"").removeAttr("title")},getTitle:function(){var c,e=this.$element,b=this.options;this.fixTitle();b=this.options;if(typeof b.title=="string")c=e.attr(b.title=="title"?"original-title":b.title);else if(typeof b.title=="function")c=b.title.call(e[0]);return(c=(""+c).replace(/(^\s*|\s*$)/,""))||b.fallback},tip:function(){if(!this.$tip){this.$tip=
a('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>');this.$tip.data("tipsy-pointee",this.$element[0])}return this.$tip},validate:function(){if(!this.$element[0].parentNode){this.hide();this.options=this.$element=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled}};a.fn.tipsy=function(c){function e(i){var j=a.data(i,"tipsy");if(!j){j=new h(i,a.fn.tipsy.elementOptions(i,
c));a.data(i,"tipsy",j)}return j}function b(){var i=e(this);i.hoverState="in";if(c.delayIn==0)i.show();else{i.fixTitle();setTimeout(function(){i.hoverState=="in"&&i.show()},c.delayIn)}}function d(){var i=e(this);i.hoverState="out";c.delayOut==0?i.hide():setTimeout(function(){i.hoverState=="out"&&i.hide()},c.delayOut)}if(c===true)return this.data("tipsy");else if(typeof c=="string"){var f=this.data("tipsy");f&&f[c]();return this}c=a.extend({},a.fn.tipsy.defaults,c);c.live||this.each(function(){e(this)});
if(c.trigger!="manual"){f=c.live?"live":"bind";var g=c.trigger=="hover"?"mouseleave":"blur";this[f](c.trigger=="hover"?"mouseenter":"focus",b)[f](g,d)}return this};a.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:false,fallback:"",gravity:"n",html:false,live:false,offset:0,opacity:0.8,title:"title",trigger:"hover"};a.fn.tipsy.revalidate=function(){a(".tipsy").each(function(){var c=a.data(this,"tipsy-pointee"),e;if(!(e=!c)){a:{for(c=c;c=c.parentNode;)if(c==document){c=true;break a}c=false}e=
!c}e&&a(this).remove()})};a.fn.tipsy.elementOptions=function(c,e){return a.metadata?a.extend({},e,a(c).metadata()):e};a.fn.tipsy.autoNS=function(){return a(this).offset().top>a(document).scrollTop()+a(window).height()/2?"s":"n"};a.fn.tipsy.autoWE=function(){return a(this).offset().left>a(document).scrollLeft()+a(window).width()/2?"e":"w"};a.fn.tipsy.autoBounds=function(c,e){return function(){var b={ns:e[0],ew:e.length>1?e[1]:false},d=a(document).scrollTop()+c,f=a(document).scrollLeft()+c,g=a(this);
if(g.offset().top<d)b.ns="n";if(g.offset().left<f)b.ew="w";if(a(window).width()+a(document).scrollLeft()-g.offset().left<c)b.ew="e";if(a(window).height()+a(document).scrollTop()-g.offset().top<c)b.ns="s";return b.ns+(b.ew?b.ew:"")}}})(jQuery);
(function(a){var h=function(b,d){this.options=d;this.$element=a(b).delegate('[data-dismiss="modal"]',"click.dismiss.modal",a.proxy(this.hide,this));this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};h.prototype={constructor:h,toggle:function(){return this[!this.isShown?"show":"hide"]()},show:function(){var b=this,d=a.Event("show");this.$element.trigger(d);if(!(this.isShown||d.isDefaultPrevented())){this.isShown=true;this.escape();this.backdrop(function(){var f=a.support.transition&&
b.$element.hasClass("fade");b.$element.parent().length||b.$element.appendTo(document.body);b.$element.show();b.$element.addClass("in").attr("aria-hidden",false);b.enforceFocus();f?b.$element.one(a.support.transition.end,function(){b.$element.focus().trigger("shown")}):b.$element.focus().trigger("shown")})}},hide:function(b){b&&b.preventDefault();b=a.Event("hide");this.$element.trigger(b);if(!(!this.isShown||b.isDefaultPrevented())){this.isShown=false;this.escape();a(document).off("focusin.modal");
this.$element.removeClass("in").attr("aria-hidden",true);a.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()}},enforceFocus:function(){var b=this;a(document).on("focusin.modal",function(d){b.$element[0]!==d.target&&!b.$element.has(d.target).length&&b.$element.focus()})},escape:function(){var b=this;if(this.isShown&&this.options.keyboard)this.$element.on("keyup.dismiss.modal",function(d){d.which==27&&b.hide()});else this.isShown||this.$element.off("keyup.dismiss.modal")},
hideWithTransition:function(){var b=this,d=setTimeout(function(){b.$element.off(a.support.transition.end);b.hideModal()},500);this.$element.one(a.support.transition.end,function(){clearTimeout(d);b.hideModal()})},hideModal:function(){var b=this;this.$element.hide();this.backdrop(function(){b.removeBackdrop();b.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove();this.$backdrop=null},backdrop:function(b){var d=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&
this.options.backdrop){var f=a.support.transition&&d;this.$backdrop=a('<div class="modal-backdrop '+d+'" />').appendTo(document.body);this.$backdrop.click(this.options.backdrop=="static"?a.proxy(this.$element[0].focus,this.$element[0]):a.proxy(this.hide,this));this.$backdrop.addClass("in");if(b)f?this.$backdrop.one(a.support.transition.end,b):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(a.support.transition.end,
b):b()}else b&&b()}};var c=a.fn.modal;a.fn.modal=function(b){return this.each(function(){var d=a(this),f=d.data("modal"),g=a.extend({},a.fn.modal.defaults,d.data(),typeof b=="object"&&b);f||d.data("modal",f=new h(this,g));if(typeof b=="string")f[b]();else g.show&&f.show()})};a.fn.modal.defaults={backdrop:true,keyboard:true,show:true};a.fn.modal.Constructor=h;a.fn.modal.noConflict=function(){a.fn.modal=c;return this};a(document).on("click.modal.data-api",'[data-toggle="modal"]',function(b){var d=a(this),
f=d.attr("href"),g=a(d.attr("data-target")||f&&f.replace(/.*(?=#[^\s]+$)/,""));f=g.data("modal")?"toggle":a.extend({remote:!/#/.test(f)&&f},g.data(),d.data());b.preventDefault();g.modal(f).one("hide",function(){d.focus()})});var e=a(document.body).on("shown",".modal",function(){e.addClass("modal-open")}).on("hidden",".modal",function(){e.removeClass("modal-open")})})(window.jQuery);
(function(a){if(!window.localStorage)return false;var h=window.localStorage;a.persist={clear:function(){h.removeItem("period");h.removeItem("year")},save:function(c){h.setItem("period",c.period);h.setItem("year",c.year);console.log("Saved: ",c)},load:function(c){var e=h.getItem("year"),b=h.getItem("period");c.year.filter("[value='"+e+"']").attr("checked",true);c.period.filter("[value='"+b+"']").attr("checked",true);c.callback()}};a.fn.persist=function(c){return this.each(function(){var e=a(this).find(c.year),
b=a(this).find(c.period),d=a(c.save),f=a(c.clear);a.persist.load({year:e,period:b,callback:c.callback});e.add(b).on("change",function(g){d.attr("disabled",false);c.callback(g)});d.on("click",function(g){g.preventDefault();a.persist.save({year:parseInt(e.filter(":checked").val()),period:parseInt(b.filter(":checked").val())});f.attr("disabled",false);d.attr("disabled",true)});f.on("click",function(g){g.preventDefault();a.persist.clear();f.attr("disabled",true)})})}})(jQuery);
$(function(){var a=$("#courses-form");a.find("input");var h=$("#courses-container");a.persist({year:"#years-field input",period:"#periods-field input",save:"#save-config",clear:"#clear-config",callback:function(){a.find(".loading").fadeIn();var c={action:"it_courses_filter",year:parseInt(a.find("#years-field input").filter(":checked").val()),period:parseInt(a.find("#periods-field input").filter(":checked").val())};$.get(pageOptions.ajaxURL,c,function(e){a.find(".loading").hide();h.html(e)})}})});
(function(a){a.fn.replaceText=function(h,c,e){return this.each(function(){var b=this.firstChild,d,f,g=[];if(b){do if(b.nodeType===3){d=b.nodeValue;f=d.replace(h,c);if(f!==d)if(!e&&/</.test(f)){a(b).before(f);g.push(b)}else b.nodeValue=f}while(b=b.nextSibling)}g.length&&a(g).remove()})}})(jQuery);
var Chalmers=function(a){a=a||{};a.linkify=function(h){if(h)h=h.replace(/((https?\:\/\/)|(www\.))(\S+)(\w{2,4})(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi,function(c){var e=c;e.match("^https?://")||(e="http://"+e);return'<a href="'+e+'">'+c+"</a>"});return h};return a}(window.Chalmers);(function(a){a.fn.jb_animate=function(h){return this.each(function(){a(this).addClass(h).on("webkitAnimationEnd animationend",function(){a(this).removeClass(h)})})}})(jQuery);
(function(a){a.fn.tabs=function(h){if(h.tabContainer===undefined)return false;var c=a(this),e={activeClass:"current",useHash:true,hashPrefix:"tab-",el:"a"};e=a.extend({},e,h);return this.each(function(){var b=a(e.tabContainer),d=location.hash&&"#"+e.hashPrefix+location.hash.replace("#","");d=e.useHash&&d||":first";b.hide().filter(d).show();a(this).find(e.el).on("click",function(f){f.preventDefault();f=b.filter(this.hash);b.hide();f.show();c.find(e.el).removeClass(e.activeClass);a(this).addClass(e.activeClass);
location.hash=f.attr("id").replace(e.hashPrefix,"")});d==":first"?a(this).find(e.el).filter(d).click():a(this).find(e.el).filter('[href="'+d+'"]').click()})}})(jQuery);
(function(a){a.loadMorePosts=function(h){h=a(h);var c=pageOptions.startPage+1,e=pageOptions.maxPages,b=pageOptions.nextLink;h.find("footer").remove();c<=e&&h.append('<div class="post-placeholder-'+c+'"></div>').append('<footer><a href="#" class="btn wide">Fler nyheter</a></footer>');a(".news footer a").on("click",function(d){d.preventDefault();var f=a(this);if(c<=e){f.text("Laddar ...");a(".post-placeholder-"+c).load(b+" [role='article']",function(){c++;b=b.replace(/\/page\/[0-9]?/,"/page/"+c);a(".news > footer").before('<div class="post-placeholder-'+
c+'"></div>');c<=e?f.text("Fler nyheter"):f.text("Inga fler nyheter finns").attr("disabled",true)})}})}})(jQuery);
$(function(){$(".home #login-btn").on("click",function(a){a.preventDefault();$(".user-area form").jb_animate("shake").find("input[type='text']:first").focus()});$("#user-avatar-link").on("click",function(a){a.preventDefault();a=$("<iframe />",{src:this.href,scrolling:"no",id:"avatar-iframe",frameborder:"no",allowTransparency:"true"});$("#avatar-modal").append(a).modal("show");a.on("load",function(){$(this).contents().find("#user-avatar-step3-close").removeAttr("onclick").on("click",function(h){h.preventDefault();
$("#avatar-modal").modal("hide")})})});$("#avatar-modal").on("hidden",function(){$(this).find("iframe").remove()});$(".smooth").smoothScroll({offset:-100});$(".comment-action").smoothScroll({afterScroll:function(){$("#comment").focus()}});$("#main-nav-toggle").on("click",function(){$(".inner-bar").slideToggle(200)});$("#comment").on("focus",function(){$(this).next(".comment-submit").show().find("#submit").attr("disabled",true)}).on("input",function(){var a=$(this).val();$(this).next(".comment-submit").find("#submit").attr("disabled",
a==="")});$(".autosize").autosize({append:"\n\n\n"});$.fn.tipsy.elementOptions=function(a,h){return $.extend({},h,{gravity:$(a).data("tooltip-gravity")||"s",offset:parseInt($(a).data("tooltip-offset"))||0})};$("h1, h2, p, li, a").replaceText(/sexit/gi,'<span class="sexit">sex<strong>IT</strong></span>');"ontouchstart"in document&&$("#tools-menu-trigger").on("touchstart",function(){var a=$(this).next(".dropdown-sub");a.hasClass("open")?a.removeClass("open").slideUp(100):a.addClass("open").slideDown(200)});
$('[rel="tooltip"]').tipsy({gravity:"s",offset:5});$("article .article-content img:not(.avatar)").each(function(){$(this).parent().is("figure")&&$(this).parent().addClass("subtle-border")});$(".tabs").tabs({tabContainer:".tab-container > div",activeClass:"tab-current"});$("[role='search'] input").on("keyup",function(a){a.which==27&&this.blur()});$(".it_twitter").each(function(){var a=this,h=$(this).children("meta[name=twitter-content]").attr("content"),c=$(this).children("meta[name=twitter-type]").attr("content"),
e=$(this).children("meta[name=twitter-count]").attr("content"),b="https://";if(c==="user")b+="api.twitter.com/1/statuses/user_timeline/";b+=h+".json?callback=?";console.log(b);$.getJSON(b,function(d){var f=$("<ul />",{"class":"list"});d!=null?$.each(d,function(g){var i=new Date(this.created_at);i="<p>"+Chalmers.linkify(this.text)+"</p><time>"+i.toDateString()+"</time>";i=$("<li />",{html:i});f.append(i);return g<e-1}):f.html("<li>Kunde inte h\u00e4mta tweets fr\u00e5n Twitter</li>");$(a).find("#tweet-list").append(f)})})});
